<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/favicon.png">

    <title>cwrap - socket_wrapper</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="assets/jumbotron.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  <link href="assets/content.css" type="text/css" rel="stylesheet"></head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <!--<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          -->
          <a class="navbar-brand" href="/">cwrap</a>
        </div>
        <!--
        <div class="navbar-collapse collapse">
          <form class="navbar-form navbar-right" role="form">
            <div class="form-group">
              <input placeholder="Email" class="form-control" type="text">
            </div>
            <div class="form-group">
              <input phnomarkers="true" placeholder="Password" class="form-control" type="password"><br><table style="width: 30px;margin: 0;padding: 0"><tr style="margin: 0;padding: 0"><td title="Click for Password Hasher" class="passhash_marker" id="null_passhash_marker_1" style="border: thin solid #80c080;background-color: #eeffee;margin: 0 1px;padding: 0;font: 12px serif;color: #609060;cursor: pointer;min-width: 12px;text-align: center;vertical-align: middle;">#</td></tr></table>
            </div>
            <button type="submit" class="btn btn-success">Sign in</button>
          </form>
        </div>--><!--/.navbar-collapse -->
      </div>
    </div>

    <div class="container">
        <h1>The socket_wrapper library</h1>
        <!-- Example row of columns -->
        <div class="row">
            <div class="col-md-7">

                <p>socket_wrapper is a library passing all socket communications through unix sockets.</p>

                <p>
                <video width="920" height="285" autoplay>
                    <source src="swrap/swrap.webm" type='video/webm;codecs="vp8, vorbis"' />
                    <source src="swrap/swrap.mp4" type='video/mp4;codecs="avc1.42E01E, mp4a.40.2"' />
                    <img src="swrap/swrap.png" width="920" height="285" />
                </video>
                </p>

                <h2>Features</h2>

                <p>socket_wrapper aims to help client/server software
                development teams willing to gain full functional test
                coverage. It makes possible to run several instances of the
                full software stack on the same machine and perform locally
                functional testing of complex network configurations.</p>

                <ul>
                    <li>Redirects all network communication to happen over unix sockets.</li>
                    <li>Support for IPv4 and IPv6 socket and addressing emulation.</li>
                    <li>Ablility to capture network traffic in pcap format.</li>
                </ul>

                <h2>Detailed descriptions</h2>
                <ul>
                    <li>The idea and the first incarnation of socket_wrapper
                    has been written by Jelmer Vernooij in 2005. It made it
                    possible to run the Samba torture suite against smbd in
                    'make test'. Since then socket_wrapper has evolved
                    significantly.</li>

                    <li>How does it work? The user defines a directory where to
                    put all the unix sockets using the envionment variable
                    "SOCKET_WRAPPER_DIR=/path/to/socket_dir". When a server
                    opens a port or a client wants to connect, socket_wrapper
                    will translate IP addresses to a special socket_wrapper
                    name and look for the relevant unix socket in the
                    SOCKET_WRAPPER_DIR.</li>

                    <li>Additionally, the default interface to be used by an
                    application is defined with
                    "SOCKET_WRAPPER_DEFAULT_IFACE=&lt;ID&gt;" where &lt;ID&gt; is between 2
                    and 254. This is analogous to use the IPv4 addresses
                    "127.0.0.&lt;ID&gt;" or IPv6 addresses "fd00::5357:5f&lt;IDx&gt;"
                    (where &lt;IDx&gt; is a hexadecimal presentation of &lt;ID&gt;). You
                    should always set the default interface. If you listen on
                    INADDR_ANY then it will use the default interface to listen
                    on.</li>

                    <li>    When debugging,it is often interesting to
                    investigate the network traffic between the client and
                    server within your application. If you define
                    SOCKET_WRAPPER_PCAP_FILE=/path/to/file.pcap, socket_wrapper
                    will dump all your network traffic to the specified file.
                    After the test has been finished you're able to open the
                    file for example with
                    <a href="https://www.wireshark.org/" target="_blank">Wireshark</a>
                    </li>

                </ul>

                <h2>Example</h2>
<pre># Open a console and create a directory for the unix sockets.
$ mktemp -d
/tmp/tmp.bQRELqDrhM

# Then start nc to listen for network traffic using the temporary directory.
$ LD_PRELOAD=libsocket_wrapper.so SOCKET_WRAPPER_DIR=/tmp/tmp.bQRELqDrhM SOCKET_WRAPPER_DEFAULT_IFACE=10 nc -v -l 127.0.0.10 7

# (If nc, listens on 0.0.0.0 then listener will be open on 127.0.0.10 cause it is the default interface)

# Now open another console and start 'nc' as a client to connect to the server:
$ LD_PRELOAD=libsocket_wrapper.so SOCKET_WRAPPER_DIR=/tmp/tmp.bQRELqDrhM SOCKET_WRAPPER_DEFAULT_IFACE=100 nc -v 127.0.0.10 7

# (The client will use the address 127.0.0.100 when connecting to the server)
# Now you can type 'Hello!' which will be sent to the server and should appear in the console output of the server.</pre>


            </div> <!-- /col -->
        </div>

       <hr>

       <footer>
           <p>Â© Andreas Schneider 2013</p>
       </footer>
   </div> <!-- /container -->

   <!-- Bootstrap core JavaScript
        ================================================== -->
   <!-- Placed at the end of the document so the pages load faster -->
   <script src="assets/jquery-1.js"></script>
   <script src="assets/bootstrap.min.js"></script>

</body></html>
